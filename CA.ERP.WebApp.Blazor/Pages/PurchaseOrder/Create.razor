@page "/purchase-order/create"

@using CA.ERP.Shared.Dto.Branch;
@using CA.ERP.Shared.Dto.Supplier;
@using CA.ERP.WebApp.Blazor.ViewModels.PurchaseOrder;



@inherits ViewBase<PurchaseOrderCreateViewModel>

<MudContainer>

    <MudGrid>
        <MudItem xs="10">
            <MudText Typo="Typo.h6">New Purchase Orders</MudText>
        </MudItem>
        <MudItem xs="2" Class="d-flex flex-row-reverse">
            <MudIconButton Icon="@Icons.Material.Outlined.MoreVert" />
        </MudItem>


    </MudGrid>
    <MudForm @ref="form" @bind-IsValid="@success" @bind-Errors="@errors">
        <MudGrid>
            <MudItem xs="12" sm="6">
                <MudGrid>
                    <MudItem xs="6">
                        @if (ViewModel.BranchesIsLoading)
                        {
                            <MudField>
                                <MudText>Loading Branches</MudText>
                            </MudField>
                        }
                        else
                        {
                            <MudAutocomplete T="BranchView" Label="Branch" @bind-Value="ViewModel.Branch" SearchFunc="@ViewModel.SearchBranches" ToStringFunc="@(b => b.Name)" ResetValueOnEmptyText="true" CoerceText="true" MaxItems="null" />
                        }
                    </MudItem>
                    <MudItem xs="12">
                        <MudGrid>
                            <MudItem xs="12" md="6">

                                @if (ViewModel.Suppliers.Count <= 0)
                                {
                                    <MudField>

                                        <MudText>Loading Supplier</MudText>

                                    </MudField>
                                }
                                else
                                {
                                    <MudAutocomplete T="SupplierView" Label="Supplier" @bind-Value="ViewModel.SelectedSupplier" SearchFunc="@ViewModel.SearchSuppliers" ToStringFunc="@(s => s.Name)" ResetValueOnEmptyText="true" CoerceText="true" MaxItems="null" />
                                }

                            </MudItem>
                            <MudItem xs="12" md="2">

                            </MudItem>
                        </MudGrid>
                    </MudItem>
                </MudGrid>
            </MudItem>
            <MudItem xs="12" sm="6">
                <MudGrid>
                    <MudItem xs="6">
                        <MudDatePicker Label="Delivery Date"></MudDatePicker>
                    </MudItem>
                </MudGrid>
            </MudItem>
        </MudGrid>
        <MudGrid>
            <MudItem xs="12" sm="6">
                @if (ViewModel.SelectedSupplier == null)
                {
                    <MudField>
                        <MudText>Please select a  supplier</MudText>
                    </MudField>
                }
                else if (ViewModel.SupplierBrands.Count <= 0)
                {
                    <MudField>
                        <MudText>Loading brands</MudText>
                    </MudField>
                }
                else
                {
                    <MudAutocomplete T="SupplierBrandView" Label="Brand" @bind-Value="ViewModel.SelectedSupplierBrand" SearchFunc="@ViewModel.SearchSupplierBrand" ToStringFunc="@(b => b.BrandName)" ResetValueOnEmptyText="true" CoerceText="true" MaxItems="null" />
                }
            </MudItem>
        </MudGrid>

    </MudForm>


</MudContainer>

@code {
    bool success;
    string[] errors = { };
    MudTextField<string> pwField1;
    MudForm form;

    string sample = "weee";

}
